<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>St. Mark's Institute</title>
    <!--/*/ <th:block th:include="fragments/headerinc :: head"></th:block> /*/-->
</head>
<body style="background-color: #122b40">
<div class="container-fluid" style="background-color:#122b40;">
    <div class="page-wrapper">
        <div class="row">

            <div class="col-lg-12">
                <h1 class="page-header" style="color: white">Monitoring</h1>
            </div>
            <div class="row">
                <form class="col-md-6" th:object="${student}" th:action="@{/monitorStudent}" th:method="POST">
                    Please tap the rfid: <input id="rfidTag" th:field="*{rfid}" class="form-control"
                                                autofocus="true"
                                                style="border-color: transparent; color: transparent"   />

                    <input type="submit" id="submit" hidden="hidden" style="color:#122b40; opacity: 0;"/>
                </form>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-6">
                <table style="float: left; margin-left: 40px;padding: 20px; margin-left: 200px">
                    <tbody>
                    <tr>
                        <td colspan="2">
                            <img id="imageIn" width="360" height="360"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h4 style="color: white">First Name :</h4>
                        </td>
                        <td style="color: white" th:text="${stud.firstName}">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h4 style="color: white">Last Name :</h4>
                        </td>
                        <td style="color: white" th:text="${stud.lastName}">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h4 style="color: white">Middle Name :</h4>
                        </td>
                        <td style="color: white" th:text="${stud.middleName}">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label><h4 style="color: white">Time IN: </h4></label>
                        </td>
                        <td>
                            <label style="color: white" th:text="${stud1.logDateTime}"></label>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-lg-6">
                <table style="float: left; margin-left: 150px; padding: 20px;">
                    <tbody>
                    <tr>
                        <td colspan="2">
                            <img id="imageOut" width="360" height="360"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h4 style="color: white">First Name :</h4>
                        </td>
                        <td style="color: white" th:text="${stud1.firstName}">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h4 style="color: white">Last Name :</h4>
                        </td>
                        <td style="color: white" th:text="${stud1.lastName}">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <h4 style="color: white">Middle Name :</h4>
                        </td>
                        <td style="color: white" th:text="${stud1.middleName}">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label><h4 style="color: white">Time OUT:</h4></label>
                        </td>
                        <td>
                            <label style="color: white" th:text="${stud1.logDateTime}"></label>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <label id="studInId" th:text="${stud.id}" hidden="false"></label>
                <label id="studOutId" th:text="${stud1.id}" hidden="false"></label>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function() {
        var studIn = $('#studInId').text();
        var studOut = $('#studOutId').text();
        var filename = getFilename(studIn);
        console.log("FN - " + filename);
    });

    var getFilename = function(userId){
        $.ajax({
            type: 'GET',
            contentType: 'application/json; charset=utf-8',
            url: '/getPictureFilename',
            data: {userId: userId},
            success: function(response){
                var res = String(response);
                console.log("RES - " + res);
                if(res){
                     alert(getImage(res));
                     $('.imageIn').src = res;
                }
            },
            error: function(response){
                console.log("error", response);
            }
        });
    };

    var getImage = function(filename){
        $.ajax({
            type: 'GET',
            contentType: 'application/json; charset=utf-8',
            url: '/files/' + filename,
            success: function(response){
                return response;
            }
        });
    }
</script>

</body>
</html>